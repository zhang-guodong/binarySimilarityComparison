//
// Created by zhanggd on 18-4-30.
//

#ifndef JAVACLASSTOTOKEN_JAVACLASSTOTOKEN_H
#define JAVACLASSTOTOKEN_JAVACLASSTOTOKEN_H

#include <iostream>
#include <fstream>
#include <stdlib.h>
#include <unistd.h>

#include <vector>
#include <map>
#include <string>

using namespace std;


class JavaClassToToken {
public:
//    JavaClassToToken(const map<string, int> &mnemonicMap);

    vector<int> javapClassToToken(string classPath);

	map<string, int> mnemonicMap = {
			{"nop",             0},
			{"aconst_null",     1},
			{"iconst_m1",       2},
			{"iconst_0",        3},
			{"iconst_1",        4},
			{"iconst_2",        5},
			{"iconst_3",        6},
			{"iconst_4",        7},
			{"iconst_5",        8},
			{"lconst_0",        9},
			{"lconst_1",        10},
			{"fconst_0",        11},
			{"fconst_1",        12},
			{"fconst_2",        13},
			{"dconst_0",        14},
			{"dconst_1",        15},
			{"bipush",          16},
			{"sipush",          17},
			{"ldc",             18},
			{"ldc_w",           19},
			{"ldc2_w",          20},
			{"iload",           21},
			{"lload",           22},
			{"fload",           23},
			{"dload",           24},
			{"aload",           25},
			{"iload_0",         26},
			{"iload_1",         27},
			{"iload_2",         28},
			{"iload_3",         29},
			{"lload_0",         30},
			{"lload_1",         31},    //32
			{"lload_2",         32},
			{"lload_3",         33},
			{"fload_0",         34},
			{"fload_1",         35},
			{"fload_2",         36},
			{"fload_3",         37},
			{"dload_0",         38},
			{"dload_1",         39},
			{"dload_2",         40},
			{"dload_3",         41},
			{"aload_0",         42},
			{"aload_1",         43},
			{"aload_2",         44},
			{"aload_3",         45},
			{"iaload",          46},
			{"laload",          47},
			{"faload",          48},
			{"daload",          49},
			{"aaload",          50},
			{"baload",          51},
			{"caload",          52},
			{"saload",          53},
			{"istore",          54},
			{"lstore",          55},
			{"fstore",          56},
			{"dstore",          57},
			{"astore",          58},
			{"istore_0",        59},
			{"istore_1",        60},
			{"istore_2",        61},
			{"istore_3",        62},
			{"lstore_0",        63},
			{"lstore_1",        64},
			{"lstore_2",        65},
			{"lstore_3",        66},
			{"fstore_0",        67},
			{"fstore_1",        68},
			{"fstore_2",        69},   //38
			{"fstore_3",        70},
			{"dstore_0",        71},
			{"dstore_1",        72},
			{"dstore_2",        73},
			{"dstore_3",        74},
			{"astore_0",        75},
			{"astore_1",        76},
			{"astore_2",        77},
			{"astore_3",        78},
			{"iastore",         79},
			{"lastore",         80},
			{"fastore",         81},
			{"dastore",         82},
			{"aastore",         83},
			{"bastore",         84},
			{"castore",         85},
			{"sastore",         86},
			{"pop",             87},
			{"pop2",            88},
			{"dup",             89},
			{"dup_x1",          90},
			{"dup_x2",          91},
			{"dup2",            92},
			{"dup2_x1",         93},
			{"dup2_x2",         94},
			{"swap",            95},
			{"iadd",            96},
			{"ladd",            97},
			{"fadd",            98},
			{"dadd",            99},
			{"isub",            100},
			{"lsub",            101},
			{"fsub",            102},
			{"dsub",            103},
			{"imul",            104},
			{"lmul",            105}, //36
			{"fmul",            106},
			{"dmul",            107},
			{"idiv",            108},
			{"ldiv",            109},
			{"fdiv",            110},
			{"ddiv",            111},
			{"irem",            112},
			{"lrem",            113},
			{"frem",            114},
			{"drem",            115},
			{"ineg",            116},
			{"lneg",            117},
			{"fneg",            118},
			{"dneg",            119},
			{"ishl",            120},
			{"lshl",            121},
			{"ishr",            122},
			{"lshr",            123},
			{"iushr",           124},
			{"lushr",           125},
			{"iand",            126},
			{"land",            127},
			{"ior",             128},
			{"lor",             129},
			{"ixor",            130},
			{"lxor",            131},
			{"iinc",            132},
			{"i2l",             133},
			{"i2f",             134},
			{"i2d",             135},
			{"l2i",             136},
			{"l2f",             137},
			{"l2d",             138},
			{"f2i",             139},
			{"f2l",             140},
			{"f2d",             141},
			{"d2i",             142},
			{"d2l",             143},    //38
			{"d2f",             144},
			{"i2b",             145},
			{"i2c",             146},
			{"i2s",             147},
			{"lcmp",            148},
			{"fcmpl",           149},
			{"fcmpg",           150},
			{"dcmpl",           151},
			{"dcmpg",           152},
			{"ifeq",            153},
			{"ifne",            154},
			{"iflt",            155},
			{"ifge",            156},
			{"ifgt",            157},
			{"ifle",            158},
			{"if_icmpeq",       159},
			{"if_icmpne",       160},
			{"if_icmplt",       161},
			{"if_icmpge",       162},
			{"if_icmpgt",       163},
			{"if_icmple",       164},
			{"if_acmpeq",       165},
			{"if_acmpne",       166},
			{"goto",            167},
			{"jsr",             168},
			{"ret",             169},
			{"tableswitch",     170},
			{"lookupswitch",    171},
			{"ireturn",         172},
			{"lreturn",         173},
			{"freturn",         174},
			{"dreturn",         175},
			{"areturn",         176},
			{"return",          177},
			{"getstatic",       178},  //35
			{"putstatic",       179},
			{"getfield",        180},
			{"putfield",        181},
			{"invokevirtual",   182},
			{"invokespecial",   183},
			{"invokestatic",    184},
			{"invokeinterface", 185},
			{"invokedynamic",   186},
			{"new",             187},
			{"newarray",        188},
			{"anewarray",       189},
			{"arraylength",     190},
			{"athrow",          191},
			{"checkcast",       192},
			{"instanceof",      193},
			{"monitorenter",    194},
			{"monitorexit",     195},
			{"wide",            196},
			{"multianewarray",  197},
			{"ifnull",          198},
			{"ifnonnull",       199},
			{"goto_w",          200},
			{"jsr_w",           201}  //23
	};

    map<int, int> classificationMap = {
            //常量入栈指令
            {1	,1 },
            {2	,1 },
            {3	,1 },
            {4	,1 },
            {5	,1 },
            {6	,1 },
            {7	,1 },
            {8	,1 },
            {9	,1 },
            {10	,1 },
            {11	,1 },
            {12	,1 },
            {13	,1 },
            {14	,1 },
            {15	,1 },
            {16	,1 },
            {17	,1 },
            {18	,1 },
            {19	,1 },
            {20	,1 },
            //局部变量值转载到栈中指令
            {21	,2 },
            {22	,2 },
            {23	,2 },
            {24	,2 },
            {25	,2 },
            {26	,2 },
            {27	,2 },
            {28	,2 },
            {29	,2 },
            {30	,2 },
            {31	,2 },
            {32	,2 },
            {33	,2 },
            {34	,2 },
            {35	,2 },
            {36	,2 },
            {37	,2 },
            {38	,2 },
            {39	,2 },
            {40	,2 },
            {41	,2 },
            {42	,2 },
            {43	,2 },
            {44	,2 },
            {45	,2 },
            {46	,2 },
            {47	,2 },
            {48	,2 },
            {49	,2 },
            {50	,2 },
            {51	,2 },
            {52	,2 },
            {53	,2 },
            //将栈顶值保存到局部变量中指令
            {54	,2 },
            {55	,2 },
            {56	,2 },
            {57	,2 },
            {58	,2 },
            {59	,2 },
            {60	,2 },
            {61	,2 },
            {62	,2 },
            {63	,2 },
            {64	,2 },
            {65	,2 },
            {66	,2 },
            {67	,2 },
            {68	,2 },
            {69	,2 },
            {70	,2 },
            {71	,2 },
            {72	,2 },
            {73	,2 },
            {74	,2 },
            {75	,2 },
            {76	,2 },
            {77	,2 },
            {78	,2 },
            {79	,2 },
            {80	,2 },
            {81	,2 },
            {82	,2 },
            {83	,2 },
            {84	,2 },
            {85	,2 },
            {86	,2 },
            //类型转换指令	15
            {133,3 },
            {134,3 },
            {135,3 },
            {136,3 },
            {137,3 },
            {138,3 },
            {139,3 },
            {140,3 },
            {141,3 },
            {142,3 },
            {143,3 },
            {144,3 },
            {145,3 },
            {146,3 },
            {147,3 },
            //整数运算	13
            {96	,3 },
            {97	,3 },
            {100,3 },
            {101,3 },
            {104,3 },
            {105,3 },
            {108,3 },
            {109,3 },
            {112,3 },
            {113,3 },
            {116,3 },
            {117,3 },
            {132,3 },
            //浮点运算	12
            {98 ,4 },
            {99	,4 },
            {102,4 },
            {103,4 },
            {106,4 },
            {107,4 },
            {110,4 },
            {111,4 },
            {114,4 },
            {115,4 },
            {118,4 },
            {119,4 },
            //逻辑运算>移位运算	6
            {120,5 },
            {121,5 },
            {122,5 },
            {123,5 },
            {124,5 },
            {125,5 },
            //逻辑运算>按位布尔运算	6
            {126,6 },
            {127,6 },
            {128,6 },
            {129,6 },
            {130,6 },
            {131,6 },
            //控制流指令>条件跳转指令	16
            {153,7 },
            {154,7 },
            {155,7 },
            {156,7 },
            {157,7 },
            {158,7 },
            {159,7 },
            {160,7 },
            {161,7 },
            {162,7 },
            {163,7 },
            {164,7 },
            {165,7 },
            {166,7 },
            {198,7 },
            {199,7 },
            //控制流指令>比较指令	5
            {148,8 },
            {149,8 },
            {150,8 },
            {151,8 },
            {152,8 },
            //控制流指令>无条件跳转指令
            {167,9 },
            {200,9 },
            //控制流指令>表跳转指令
            {170,10},
            {171,10},
            //控制流指令>异常和finally
            {168,11},
            {169,11},
            {191,11},
            {201,11},
            //对象操作指令
            {178,12},
            {179,12},
            {180,12},
            {181,12},
            {187,12},
            {192,12},
            {193,12},
            //数组操作指令
            {188,13},
            {189,13},
            {190,13},
            {197,13},
            //方法调用指令
            {182,14},
            {183,14},
            {184,14},
            {185,14},
            {186,14},
            //方法返回指令
            {172,15},
            {173,15},
            {174,15},
            {175,15},
            {176,15},
            {177,15},
            //线程同步指令
            {194,16},
            {195,16},
            //通用（无类型）栈操作指令	//TODO:可能还需要进一步划分
            {0	,90},
            {87 ,18},
            {88 ,18},
            {89 ,18},
            {90 ,18},
            {91 ,18},
            {92 ,18},
            {93 ,18},
            {94 ,18},
            {95 ,18},
            //wide指令
            {196,91}
    };
};


#endif //JAVACLASSTOTOKEN_JAVACLASSTOTOKEN_H
